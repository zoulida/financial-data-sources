# WindPy 资金流向测试脚本使用说明

## 脚本概述

本目录包含三个WindPy资金流向测试脚本，用于验证Wind API的资金流向功能：

### 1. 个股主力净流入验证.py
**功能**: 获取600519.SH最近1个交易日的主力净流入金额
**依赖**: 仅需WindPy
**特点**: 
- 最简验证脚本，快速测试接口可用性
- 自动检查连接状态和权限
- 提供清晰的错误诊断信息

### 2. 板块资金流向可视化.py
**功能**: 获取申万一级行业最近5个交易日的板块净流入额并可视化
**依赖**: WindPy、pandas、seaborn、matplotlib
**特点**:
- 使用wset获取板块数据
- 自动生成柱状图可视化
- 提供统计信息和数据导出

### 3. 北向资金实时订阅.py
**功能**: 订阅HK999999.SH的北向净买入和剩余额度，每10秒打印一次
**依赖**: 仅需WindPy
**特点**:
- 实时数据订阅和回调处理
- 自动断线重连机制
- 统计监控结果和平均值计算

## 使用前准备

### 1. 环境要求
```bash
pip install WindPy pandas seaborn matplotlib
```

### 2. 权限要求
- **个股主力净流入**: 需要开通"沪深Level-2增强"权限
- **板块资金流向**: 需要开通"沪深Level-2增强"权限  
- **北向资金实时**: 需要开通"陆股通Level-2"权限

### 3. Wind终端设置
1. 启动Wind终端并登录
2. 点击"工具" -> "数据权限管理"
3. 开通相应的Level-2权限

## 运行说明

### 个股主力净流入验证
```bash
python 个股主力净流入验证.py
```
- 直接运行，无需参数
- 自动检查连接和权限状态
- 输出字段信息、数值和验证结果

### 板块资金流向可视化
```bash
python 板块资金流向可视化.py
```
- 自动获取申万一级行业数据
- 生成可视化图表并保存为PNG文件
- 输出统计信息和数据预览

### 北向资金实时订阅
```bash
python 北向资金实时订阅.py
```
- 实时监控1分钟（6次快照）
- 自动处理断线重连
- 计算并输出北向资金平均值

## 字段说明

### 主要字段
- `net_flow_in_main`: 主力净流入（万元）
- `net_inflow`: 板块净流入（万元）
- `north_net_in`: 北向净买入（亿元）
- `north_quota_balance`: 北向剩余额度（亿元）

### 数据单位
- 个股和板块资金流向：万元
- 北向资金：亿元

## 错误处理

### 常见错误码
- `ErrorCode = 0`: 成功
- `ErrorCode = -40520007`: 连接错误，需要重连
- 其他错误码: 权限不足或数据源问题

### 故障排除
1. **连接失败**: 检查Wind终端是否启动并登录
2. **权限错误**: 确认已开通相应的Level-2权限
3. **数据为空**: 检查字段名称和权限设置
4. **网络问题**: 确认网络连接正常

## 注意事项

1. **权限检查**: 运行前确保已开通相应的Wind权限
2. **数据时效**: 实时数据需要Wind终端保持在线
3. **字段验证**: 不同权限级别支持的字段可能不同
4. **网络稳定**: 实时订阅需要稳定的网络连接

## 技术支持

如遇到问题，请检查：
1. Wind终端状态和登录情况
2. 数据权限是否已开通
3. 网络连接是否正常
4. Python环境和依赖包是否完整
