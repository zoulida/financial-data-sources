# A股逃顶打分器 - 快速演示

## 🎬 5分钟快速上手

### 步骤1: 安装依赖（首次使用）

```bash
# Windows PowerShell 或 CMD
cd D:\pythonProject\数据源\src\大盘逃顶
pip install pandas numpy matplotlib requests beautifulsoup4 akshare

# 或使用requirements.txt
pip install -r requirements.txt
```

### 步骤2: 运行程序

#### 方法A: 双击运行（最简单）
Windows用户直接双击 `run.bat` 文件即可

#### 方法B: 命令行运行
```bash
# 简化版（推荐，无需额外配置）
python escape_top_scorer_simple.py

# 完整版（需要Wind/XtQuant）
python escape_top_scorer.py
```

### 步骤3: 查看结果

程序会：
1. ✅ 在终端显示实时评分过程和最终结果
2. ✅ 保存历史数据到 `escape_top_history.csv`
3. ✅ 生成趋势图 `escape_top_chart.png`

## 📺 运行效果示例

### 终端输出效果

```
======================================================================
A股牛市逃顶打分器 (简化版)
运行时间: 2025-10-20 16:30:00
======================================================================

[1/4] 正在获取融资余额数据（东方财富网）...
  ✓ 融资净买入情况正常
    数据: 89.23亿, 102.45亿, 76.89亿
  得分: 0.0

[2/4] 正在获取开户数数据（akshare）...
  ✓ 最近两期: 158.76万 → 162.34万
    环比变化: +2.3% (降幅: -2.3%)
  得分: 0.00

[3/4] 正在获取量价背离数据（akshare）...
  ✓ 发现 0 日量价背离
  得分: 0.00

[4/4] 正在获取估值百分位数据（akshare）...
  ✓ 当前PE: 13.45
    近5年百分位: 65.2%
  得分: 0.00

======================================================================
2025-10-20 逃顶打分
======================================================================
融资余额: 0.0 | 开户数: 0.0 | 量价背离: 0.0 | 估值百分位: 0.0

总分: 0.0/4
----------------------------------------------------------------------
【✓ 暂无明显逃顶信号】
======================================================================

✓ 历史数据已保存到: ...\escape_top_history.csv
✓ 趋势图已保存到: ...\escape_top_chart.png
```

### 危险信号示例

```
======================================================================
2025-10-20 逃顶打分
======================================================================
融资余额: 1.0 | 开户数: 0.8 | 量价背离: 1.5 | 估值百分位: 0.9

总分: 4.2/4
----------------------------------------------------------------------
【⚠️  强烈逃顶信号！】
======================================================================
```

## 🧪 测试数据源

在正式使用前，可以先测试各数据源是否可用：

```bash
python test_data_sources.py
```

输出示例：
```
======================================================================
数据源可用性测试
======================================================================

[测试 Wind API]
  ✗ WindPy 未安装
  提示: 需要先安装Wind终端，然后 pip install WindPy

[测试 XtQuant]
  ✗ xtquant 未安装
  提示: pip install xtquant

[测试 akshare]
  ✓ akshare 上证指数接口可用
  最新数据日期: 2025-10-20
  ✓ akshare 开户数接口可用

[测试东方财富网API]
  ✓ 东方财富网API 可用
  最新日期: 2025-10-20

======================================================================
测试结果汇总
======================================================================
Wind API        : ✗ 不可用
XtQuant         : ✗ 不可用
akshare         : ✓ 可用
东方财富网       : ✓ 可用

提示:
1. Wind API 和 XtQuant 为可选数据源，不影响程序运行
2. akshare 和东方财富网为必需数据源，建议确保可用
3. 如果某个数据源不可用，程序会自动切换到备用源
======================================================================
```

## 📊 趋势图预览

程序会生成两个子图的组合图表：

### 子图1：总分趋势
- 蓝色折线：每日总分
- 红色虚线：逃顶警戒线（2.2分）
- 红色星标：触发强烈逃顶信号的日期

### 子图2：指标分布
- 堆叠面积图，不同颜色表示不同指标
- 直观展示各指标对总分的贡献

## 🔄 定时自动运行

### Windows 任务计划（推荐）

1. Win+R 输入 `taskschd.msc` 打开任务计划程序
2. 右键"任务计划程序库" → "创建基本任务"
3. 名称：`A股逃顶打分器`
4. 触发器：每日 15:30
5. 操作：启动程序
   - 程序/脚本：`C:\...\venv\Scripts\python.exe`（你的Python路径）
   - 添加参数：`escape_top_scorer_simple.py`
   - 起始于：`D:\pythonProject\数据源\src\大盘逃顶`

### Linux/Mac Crontab

```bash
# 编辑crontab
crontab -e

# 添加以下行（每个交易日15:30运行）
30 15 * * 1-5 cd /path/to/src/大盘逃顶 && /path/to/python escape_top_scorer_simple.py >> log.txt 2>&1
```

## 💡 使用技巧

### 1. 查看历史数据

```bash
# 使用Excel打开
start escape_top_history.csv

# 或使用Python
python -c "import pandas as pd; print(pd.read_csv('escape_top_history.csv'))"
```

### 2. 自定义评分规则

编辑 `config_example.py` 中的 `SCORING_RULES` 配置：

```python
SCORING_RULES = {
    'financing_balance': {
        'three_negative_days': 1.0,  # 可调整
        'two_negative_days': 0.4     # 可调整
    },
    # ...
}
```

### 3. 修改逃顶阈值

```python
ESCAPE_THRESHOLD = 2.2  # 默认2.2分，可根据实际情况调整
```

### 4. 调整历史数据范围

图表默认显示近3个月数据，可在 `CHART_CONFIG` 中调整：

```python
CHART_CONFIG = {
    'history_days': 90,  # 修改为60、120等
}
```

## 🎯 实战建议

### 信号解读

| 总分范围 | 风险级别 | 建议操作 |
|---------|---------|---------|
| 0.0 - 1.0 | 低风险 | 正常持仓 |
| 1.0 - 1.5 | 轻度风险 | 保持关注 |
| 1.5 - 2.2 | 中度风险 | 警惕观察，考虑适度减仓 |
| 2.2 - 3.0 | 高风险 | 建议减仓30-50% |
| 3.0+ | 极高风险 | 建议大幅减仓或清仓 |

### 配合使用

1. **技术指标**: 结合MACD、RSI等技术指标
2. **资金面**: 关注北向资金流入流出
3. **基本面**: 关注宏观经济和政策面
4. **市场情绪**: 关注散户开户数、新基金发行等

### 注意事项

⚠️ **重要提醒**：
- 本工具仅作为辅助决策工具，不能单独作为投资依据
- 市场情况复杂，指标可能滞后或误判
- 建议结合多方面信息综合判断
- 投资有风险，决策需谨慎

## 📚 更多资料

- 📖 [README.md](README.md) - 项目概览
- 📘 [使用指南.md](使用指南.md) - 详细使用说明
- 📙 [项目说明.md](项目说明.md) - 技术实现细节
- 💻 [config_example.py](config_example.py) - 配置文件示例

## 🆘 常见问题速查

### Q: 提示"ModuleNotFoundError: No module named 'akshare'"
```bash
pip install akshare
```

### Q: 图表中文显示为方块
已在代码中设置中文字体，Windows系统一般无需额外配置

### Q: 数据获取失败
1. 检查网络连接
2. 确认是在交易日运行
3. 查看详细错误信息

### Q: 想要更准确的数据
安装Wind终端和XtQuant，使用完整版程序

---

🎉 **开始使用吧！祝投资顺利！**

