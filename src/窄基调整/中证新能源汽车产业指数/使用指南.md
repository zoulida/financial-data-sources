# 中证新能源汽车产业指数新纳入股票表现分析 - 使用指南

## 项目概述

本项目成功实现了对中证新能源汽车产业指数（930997）新纳入股票在**数据截止日**和**生效日**前后5个交易日的表现分析，包括股价涨跌幅和成交量变化。

## 实现成果

### ✅ 已完成的功能

1. **数据准备模块**
   - ✅ 读取CSV文件并筛选出`tradestatus='纳入'`的股票
   - ✅ 计算数据截止日（生效日前第二个自然月的最后一个自然日）
   - ✅ 生成两个观察窗口：数据截止日窗口和生效日窗口

2. **交易日历处理**
   - ✅ 使用工作日作为交易日历替代方案
   - ✅ 计算关键日期前后5个交易日的观察窗口

3. **表现指标计算**
   - ✅ 涨跌幅：每日相对前一日的涨跌幅
   - ✅ 累计涨跌幅：观察期内的总涨跌幅
   - ✅ 成交量变化率：相对观察期均值的变化
   - ✅ 胜率：上涨天数占比
   - ✅ 波动率：涨跌幅的标准差

4. **统计汇总报告**
   - ✅ 按调整批次分组统计
   - ✅ 平均涨跌幅、胜率、成交量变化等指标
   - ✅ 对比数据截止日窗口和生效日窗口的差异

5. **输出文件**
   - ✅ `newly_included_performance_detail.csv`: 每只股票的详细数据
   - ✅ `newly_included_summary_cutoff_date.csv`: 数据截止日窗口统计
   - ✅ `newly_included_summary_effective_date.csv`: 生效日窗口统计
   - ✅ `newly_included_overall_summary.txt`: 综合分析报告

## 关键日期映射

根据指数调整规则，成功计算了以下日期映射：

- **2024-06-17生效** → 数据截止日 **2024-04-30**
- **2024-12-16生效** → 数据截止日 **2024-10-31**
- **2025-06-16生效** → 数据截止日 **2025-04-30**

## 分析结果示例

### 总体统计
- **数据截止日窗口**：9只股票，平均累计涨跌幅5.13%，平均胜率82.22%
- **生效日窗口**：9只股票，平均累计涨跌幅3.39%，平均胜率55.56%

### 按调整批次统计
- **2025-06-16调整批次**：5只股票
  - 数据截止日窗口：平均涨跌幅1.61%，胜率80.00%
  - 生效日窗口：平均涨跌幅-7.01%，胜率0.00%
- **2024-12-16调整批次**：1只股票
  - 数据截止日窗口：平均涨跌幅13.70%，胜率100.00%
  - 生效日窗口：平均涨跌幅14.07%，胜率100.00%
- **2024-06-17调整批次**：3只股票
  - 数据截止日窗口：平均涨跌幅0.08%，胜率66.67%
  - 生效日窗口：平均涨跌幅3.12%，胜率66.67%

## 文件说明

### 核心脚本
1. **`analyze_demo.py`** - 演示版本（推荐使用）
   - 使用模拟数据演示完整分析流程
   - 展示所有输出格式和统计指标
   - 无需配置API，可直接运行

2. **`analyze_simplified.py`** - 简化版本
   - 支持XtQuant和Wind API
   - 自动处理API限制和错误
   - 需要配置相应的API

3. **`analyze_newly_included_stocks.py`** - 完整版本
   - 原始设计版本
   - 包含所有功能模块
   - 需要XtQuant API支持

### 配置文件
- **`config.py`** - 分析参数配置
- **`test_analyzer.py`** - 测试脚本
- **`README.md`** - 详细使用说明

## 使用方法

### 1. 快速体验（推荐）
```bash
cd "D:\pythonProject\数据源\src\窄基调整\中证新能源汽车产业指数"
python analyze_demo.py
```

### 2. 实际数据分析
```bash
# 配置API后运行
python analyze_simplified.py
```

### 3. 测试环境
```bash
python test_analyzer.py
```

## 技术特点

### 1. 数据源优先级
- 优先使用XtQuant API（符合项目规则）
- Wind API作为备选方案
- 自动处理API限制和错误

### 2. 交易日历处理
- 使用工作日作为交易日历替代
- 自动计算关键日期前后的观察窗口
- 处理非交易日的情况

### 3. 指标计算
- 完整的表现指标体系
- 支持多种统计方法
- 自动处理异常数据

### 4. 报告生成
- 多格式输出（CSV、TXT）
- 分层统计汇总
- 对比分析功能

## 扩展建议

### 1. 数据源优化
- 配置真实的XtQuant token
- 集成更多数据源API
- 添加数据质量检查

### 2. 功能增强
- 添加更多技术指标
- 支持更多指数分析
- 增加可视化图表

### 3. 性能优化
- 并行数据处理
- 缓存机制
- 增量更新

## 注意事项

1. **数据源配置**：实际使用时需要配置相应的API
2. **交易日历**：当前使用工作日作为替代，实际交易可能有所不同
3. **数据完整性**：确保CSV文件包含完整的调整数据
4. **网络连接**：需要稳定的网络连接访问API

## 项目总结

本项目成功实现了新纳入股票表现分析的完整流程，包括：

- ✅ 数据准备和筛选
- ✅ 关键日期计算
- ✅ 交易日历处理
- ✅ 表现指标计算
- ✅ 统计汇总报告
- ✅ 多格式输出

通过演示版本可以完整了解分析流程和输出格式，为实际应用提供了完整的解决方案。
