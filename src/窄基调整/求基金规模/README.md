# 指数基金规模汇总工具

## 功能说明

根据被动指数型基金数据，按跟踪指数代码汇总基金规模，并添加指数名称，按规模从大到小排序。

## 使用方法

### 1. 基本使用（使用默认路径）

```bash
python calculate_fund_size.py
```

### 2. 在代码中调用

```python
from calculate_fund_size import calculate_index_fund_size

# 使用默认路径
result = calculate_index_fund_size(
    excel_path=r"src\窄基调整\求基金规模\被动指数型基金.xlsx"
)

# 或指定输出路径
result = calculate_index_fund_size(
    excel_path=r"src\窄基调整\求基金规模\被动指数型基金.xlsx",
    output_path=r"src\窄基调整\求基金规模\输出.csv"
)

# 查看结果
print(result.head(10))
```

## 输入文件格式

Excel文件应包含以下列（按位置）：
- 第3列：跟踪指数代码（如：000300.SH）
- 第4列：跟踪指数名称（如：沪深300）
- 第5列：当前规模(亿元)

## 输出结果

CSV文件包含三列：
- `跟踪指数代码`：指数代码
- `跟踪指数名称`：指数名称
- `基金规模(亿元)`：该指数所有基金规模的总和

结果按基金规模从大到小排序。

## 注意事项

1. 如果CSV文件被其他程序（如Excel）打开，脚本会提示警告并跳过保存
2. 请在使用前关闭CSV文件，或指定不同的输出路径
3. 脚本会自动处理缺失值和无效数据

## 输出示例

```
跟踪指数代码,跟踪指数名称,基金规模(亿元)
000300.SH,沪深300,11346.481068
000510.SH,中证A500,2828.423911
000688.SH,科创50,2120.176052
...
```

