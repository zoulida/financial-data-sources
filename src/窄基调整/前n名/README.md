# 前N名指数成分股变动分析与新纳入股票表现研究

## 项目概述

本项目对前20名指数（排除港股通）进行批量分析，包括：
1. 下载近两年成分股变动数据
2. 计算数据截止日和生效日
3. 分析新纳入股票在数据截止日前后5个交易日的表现

## 目标指数

基于基金规模排名，筛选出前20名指数：

1. **000300.SH** - 沪深300 - 11346.48亿
2. **000510.SH** - 中证A500 - 2828.42亿
3. **000688.SH** - 科创50 - 2120.18亿
4. **000016.SH** - 上证50 - 1795.95亿
5. **000905.SH** - 中证500 - 1732.94亿
6. **399006.SZ** - 创业板指 - 1538.40亿
7. **000852.SH** - 中证1000 - 1502.55亿
8. **399975.SZ** - 证券公司 - 968.41亿
9. **980017.CNI** - 国证芯片(CNI) - 491.03亿
10. **399673.SZ** - 创业板50 - 458.38亿
11. **000685.SH** - 科创芯片 - 409.60亿
12. **399989.SZ** - 中证医疗 - 402.06亿
13. **399997.SZ** - 中证白酒 - 397.00亿
14. **931643.CSI** - 科创创业50 - 391.64亿
15. **h30269.CSI** - 红利低波 - 384.45亿
16. **930713.CSI** - CS人工智能 - 373.18亿
17. **399986.SZ** - 中证银行 - 347.65亿
18. **399967.SZ** - 中证军工 - 340.46亿
19. **930050.CSI** - 中证A50 - 318.12亿
20. **h30590.CSI** - 机器人 - 304.30亿

## 核心功能

### 1. 数据获取
- 使用Wind API获取指数成分股变动数据
- 时间范围：近两年（2023-01-01至今）
- 字段包括：股票代码、名称、变动类型、日期等

### 2. 关键日期计算
根据指数调整规则：
- **数据截止日** = 生效日前第二个自然月的最后一个自然日
- **观察窗口** = 数据截止日前后各5个交易日

### 3. 表现指标计算
- **涨跌幅**：每日相对涨跌幅
- **累计涨跌幅**：观察期内总涨跌幅
- **成交量变化率**：相对均值的成交量变化
- **胜率**：上涨天数占比
- **波动率**：涨跌幅标准差

### 4. 统计汇总
- 按指数分组统计
- 平均涨跌幅、胜率、成交量变化等
- 正向收益比例

## 文件说明

### 输入文件
- `top_indices_list.csv` - 目标指数列表
- `../求基金规模/指数基金规模汇总.csv` - 指数基金规模数据

### 输出文件
- `{指数名称}_{指数代码}_changes.csv` - 各指数成分股变动数据
- `all_indices_newly_included_analysis.csv` - 所有新纳入股票分析结果
- `indices_summary_report.csv` - 统计汇总报告

## 使用方法

### 方法1: 一键运行完整流程（推荐）
```bash
cd "D:\pythonProject\数据源\src\窄基调整\前n名"
python full_analysis.py
```

### 方法2: 分步执行

#### 1. 筛选指数列表
```bash
python filter_indices.py
```

#### 2. 运行批量分析
```bash
python batch_analyze.py
```

### 方法3: 快速分析单个指数
```bash
python quick_analyze.py <指数代码> <指数名称>
# 例如: python quick_analyze.py 930713.CSI CS人工智能
```

### Windows用户
双击运行 `run.bat` 即可

## 注意事项

1. **API配置**：需要配置Wind API
2. **时间范围**：可调整start_date和end_date参数
3. **数据量**：分析多个指数需要较长时间
4. **网络连接**：需要稳定的网络连接

## 扩展功能

- 支持更多指数
- 添加更多技术指标
- 可视化分析结果
- 横向对比不同指数

## 技术特点

- **批量处理**：自动处理多个指数
- **错误处理**：自动处理API错误和数据异常
- **结构化输出**：标准化的CSV格式
- **灵活配置**：可调整的分析参数
