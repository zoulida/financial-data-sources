# Wind Python API 错误码说明

本文档整理了Wind Python接口中的所有错误码及其含义，分为数据部分和交易部分。

## 目录
- [数据部分错误码](#数据部分错误码)
  - [基础错误 (-40520xxx)](#基础错误--40520xxx)
  - [网络错误 (-40521xxx)](#网络错误--40521xxx)
  - [请求错误 (-40522xxx)](#请求错误--40522xxx)
- [交易部分错误码](#交易部分错误码)
  - [基础错误 (-40530xxx)](#基础错误--40530xxx)
  - [认证错误 (-40530101)](#认证错误--40530101)
  - [登录错误 (-40530201-40530206)](#登录错误--40530201-40530206)
  - [连接错误 (-40530301-40530302)](#连接错误--40530301-40530302)
  - [委托错误 (-40530401-40530407)](#委托错误--40530401-40530407)
  - [撤单错误 (-40530501-40530502)](#撤单错误--40530501-40530502)
  - [查询错误 (-40530601-40530608)](#查询错误--40530601-40530608)

---

## 数据部分错误码

### 基础错误 (-40520xxx)

| 错误码 | 错误信息 | 说明 |
|--------|----------|------|
| `-40520001` | 未知错误 | 无法识别的错误类型 |
| `-40520002` | 内部错误 | Wind内部系统错误 |
| `-40520003` | 系统错误 | 系统级错误 |
| `-40520004` | 登录失败 | 无法登录到Wind服务 |
| `-40520005` | 无权限 | 当前用户无权限访问请求的数据 |
| `-40520006` | 用户取消 | 用户主动取消操作 |
| `-40520007` | 无数据 | 请求的数据不存在或无可用数据 |
| `-40520008` | 超时错误 | 请求超时 |
| `-40520009` | 本地WBOX错误 | 本地WBOX组件错误 |
| `-40520010` | 需要内容不存在 | 请求的内容不存在 |
| `-40520011` | 需要服务器不存在 | 目标服务器不存在 |
| `-40520012` | 引用不存在 | 引用的对象不存在 |
| `-40520013` | 其他地方登录错误 | 账号在其他地方登录导致当前会话失效 |
| `-40520014` | 未登录使用WIM工具，故无法登录 | 需要先登录WIM工具 |
| `-40520015` | 连续登录失败次数过多 | 登录失败次数超过限制，账号被锁定 |

### 网络错误 (-40521xxx)

| 错误码 | 错误信息 | 说明 |
|--------|----------|------|
| `-40521001` | IO操作错误 | 输入输出操作失败 |
| `-40521002` | 后台服务器不可用 | Wind后台服务器无法访问 |
| `-40521003` | 网络连接失败 | 无法建立网络连接 |
| `-40521004` | 请求发送失败 | 请求数据发送失败 |
| `-40521005` | 数据接收失败 | 无法接收返回数据 |
| `-40521006` | 网络错误 | 一般性网络错误 |
| `-40521007` | 服务器拒绝请求 | 服务器拒绝处理请求 |
| `-40521008` | 错误的应答 | 服务器返回的应答格式错误 |
| `-40521009` | 数据解码失败 | 无法解码返回的数据 |
| `-40521010` | 网络超时 | 网络请求超时 |
| `-40521011` | 频繁访问 | 访问频率超过限制 |

### 请求错误 (-40522xxx)

| 错误码 | 错误信息 | 说明 |
|--------|----------|------|
| `-40522001` | 无合法会话 | 当前会话无效或已过期 |
| `-40522002` | 非法数据服务 | 请求的数据服务不合法 |
| `-40522003` | 非法请求 | 请求格式或内容不合法 |
| `-40522004` | 万得代码语法错误 | Wind代码格式错误 |
| `-40522005` | 不支持的万得代码 | Wind代码不支持或不存在 |
| `-40522006` | 指标语法错误 | 指标名称或格式错误 |
| `-40522007` | 不支持的指标 | 请求的指标不支持或不存在 |
| `-40522008` | 指标参数语法错误 | 指标参数格式错误 |
| `-40522009` | 不支持的指标参数 | 指标参数不支持或不合法 |
| `-40522010` | 日期与时间语法错误 | 日期时间格式错误 |
| `-40522011` | 不支持的日期与时间 | 日期时间值不合法或超出范围 |
| `-40522012` | 不支持的请求参数 | 请求参数不支持或不合法 |
| `-40522013` | 数组下标越界 | 数组访问超出范围 |
| `-40522014` | 重复的WQID | 查询ID重复 |
| `-40522015` | 请求无相应权限 | 当前用户无权限访问请求的数据 |
| `-40522016` | 不支持的数据类型 | 数据类型不支持 |
| `-40522017` | 数据提取量超限 | 单次请求数据量超过限制 |

---

## 交易部分错误码

### 基础错误 (-40530xxx)

| 错误码 | 错误信息 | 说明 |
|--------|----------|------|
| `-40530001` | 数据错误 | 交易数据错误 |
| `-40530002` | 未初始化 | 交易接口未初始化 |
| `-40530003` | 功能号错 | 功能编号错误 |
| `-40530004` | 用户已登出或无此LogonID | 用户会话已失效或登录ID不存在 |
| `-40530005` | 回报队列已满 | 交易回报队列已满 |
| `-40530006` | 发送请求失败 | 交易请求发送失败 |

### 认证错误 (-40530101)

| 错误码 | 错误信息 | 说明 |
|--------|----------|------|
| `-40530101` | 未通过认证 | 身份认证失败 |

### 登录错误 (-40530201-40530206)

| 错误码 | 错误信息 | 说明 |
|--------|----------|------|
| `-40530201` | 获取配置错误 | 无法获取交易配置 |
| `-40530202` | 券商（期货商）代码错 | 券商或期货商代码错误 |
| `-40530203` | 登录代码错 | 登录代码格式或内容错误 |
| `-40530204` | 账号密码错 | 账号或密码错误 |
| `-40530205` | 账号类型错 | 账号类型不正确 |
| `-40530206` | 登录失败次数过多 | 登录失败次数超过限制 |

### 连接错误 (-40530301-40530302)

| 错误码 | 错误信息 | 说明 |
|--------|----------|------|
| `-40530301` | 建立连接失败 | 无法建立交易连接 |
| `-40530302` | 处理超时 | 交易请求处理超时 |

### 委托错误 (-40530401-40530407)

| 错误码 | 错误信息 | 说明 |
|--------|----------|------|
| `-40530401` | 交易代码错 | 证券或期货代码错误 |
| `-40530402` | 价格委托方式错 | 委托价格方式不正确 |
| `-40530403` | 委托数量错 | 委托数量不合法 |
| `-40530404` | 交易方向错 | 买卖方向错误 |
| `-40530405` | 市场代码错 | 交易市场代码错误 |
| `-40530406` | 投机套保字段错 | 投机套保标识错误（期货） |
| `-40530407` | 委托队列满 | 委托队列已满 |

### 撤单错误 (-40530501-40530502)

| 错误码 | 错误信息 | 说明 |
|--------|----------|------|
| `-40530501` | 撤单委托序号错 | 要撤销的委托序号不存在或错误 |
| `-40530502` | 委托状态不可撤单 | 当前委托状态不允许撤单 |

### 查询错误 (-40530601-40530608)

| 错误码 | 错误信息 | 说明 |
|--------|----------|------|
| `-40530601` | 查询过于频繁 | 查询频率超过限制 |
| `-40530602` | 回报数据已被新请求覆盖 | 回报数据被后续请求覆盖 |
| `-40530603` | 获取回报数据超出记录数 | 请求的回报数据超出范围 |
| `-40530604` | 多于一个的查询条件 | 查询条件过多 |
| `-40530605` | 无对应请求流水号记录 | 找不到对应的请求记录 |
| `-40530606` | 无对应委托回报 | 找不到对应的委托回报 |
| `-40530607` | 委托失败 | 委托操作失败 |
| `-40530608` | 委托已发送 | 委托已经发送，不能重复操作 |

---

## 使用示例

### 错误处理示例

```python
import WindPy as w

# 启动Wind API
w.start()

# 获取数据
result = w.wsd("000001.SZ", "close", "2024-01-01", "2024-01-31")

# 检查错误码
if result.ErrorCode != 0:
    error_code = result.ErrorCode
    
    # 数据部分错误
    if error_code == -40520007:
        print("无数据：请检查股票代码、日期范围或指标名称")
    elif error_code == -40520005:
        print("无权限：您没有权限访问该数据")
    elif error_code == -40521011:
        print("频繁访问：请降低访问频率")
    elif error_code == -40522004:
        print("Wind代码语法错误：请检查股票代码格式")
    elif error_code == -40522006:
        print("指标语法错误：请检查指标名称")
    elif error_code == -40522017:
        print("数据提取量超限：请减少单次请求的数据量")
    else:
        print(f"错误码: {error_code}")
else:
    print("数据获取成功")
    print(result.Data)

# 关闭Wind API
w.stop()
```

### 常见错误处理方案

#### 1. 无数据错误 (-40520007)
**可能原因：**
- 股票代码错误
- 日期范围超出数据范围
- 指标名称错误
- 该股票在指定日期未上市或已退市

**解决方案：**
- 验证股票代码格式（如 `000001.SZ`）
- 检查日期范围是否合理
- 确认指标名称正确

#### 2. 无权限错误 (-40520005 或 -40522015)
**可能原因：**
- 用户没有订阅相应的数据服务
- 访问了限制级别的数据

**解决方案：**
- 联系Wind客服确认数据权限
- 升级数据服务套餐

#### 3. 频繁访问错误 (-40521011)
**可能原因：**
- 请求频率过高
- 短时间内发送大量请求

**解决方案：**
- 在请求之间添加延时（如 `time.sleep(0.5)`）
- 批量请求数据而不是逐条请求
- 使用缓存机制避免重复请求

#### 4. 数据提取量超限 (-40522017)
**可能原因：**
- 单次请求的股票数量过多
- 请求的时间范围过长
- 请求的指标数量过多

**解决方案：**
- 分批请求数据
- 缩短时间范围
- 减少单次请求的指标数量

#### 5. 网络错误 (-40521xxx)
**可能原因：**
- 网络连接不稳定
- Wind服务器维护
- 防火墙或代理设置问题

**解决方案：**
- 检查网络连接
- 重试请求
- 检查防火墙设置
- 联系IT支持

---

## 错误码快速查询

### 按功能分类

**认证和权限类：**
- `-40520004`: 登录失败
- `-40520005`: 无权限
- `-40520013`: 其他地方登录错误
- `-40520015`: 连续登录失败次数过多
- `-40522001`: 无合法会话
- `-40522015`: 请求无相应权限

**数据请求类：**
- `-40520007`: 无数据
- `-40522004`: Wind代码语法错误
- `-40522006`: 指标语法错误
- `-40522010`: 日期与时间语法错误
- `-40522017`: 数据提取量超限

**网络连接类：**
- `-40521003`: 网络连接失败
- `-40521006`: 网络错误
- `-40521010`: 网络超时
- `-40521011`: 频繁访问

**系统错误类：**
- `-40520001`: 未知错误
- `-40520002`: 内部错误
- `-40520003`: 系统错误
- `-40521002`: 后台服务器不可用

---

## 注意事项

1. **错误码为负数**：所有Wind API的错误码都是负数，成功时ErrorCode为0
2. **错误处理**：建议在每次API调用后检查ErrorCode
3. **日志记录**：建议记录错误码和错误信息，便于问题排查
4. **重试机制**：对于网络相关错误，建议实现重试机制
5. **频率限制**：注意控制请求频率，避免触发限流
6. **权限管理**：定期检查数据权限，确保可以访问所需数据

---

## 相关文档

- [Wind数据获取完整指南](./Wind数据获取完整指南.md)
- [Wind官方文档](https://www.wind.com.cn/)
- Wind客服电话：400-820-9463

---

**更新日期：** 2025-10-20

