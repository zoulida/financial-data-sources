# Wind API - 融资余额数据获取

本目录包含Wind API获取融资融券交易数据的完整文档和示例代码。

## 📁 目录结构

```
融资余额/
├── README.md                    # 本文件
├── 融资余额API使用说明.md        # 详细的API使用文档
└── 示例代码.py                   # 可运行的示例代码
```

## 📖 快速开始

### 1. API调用示例

```python
from WindPy import w
w.start()

# 获取融资余额数据
data = w.wset(
    "margintradingsizeanalys(value)",
    "exchange=all;startdate=2025-07-20;enddate=2025-10-20;frequency=day;sort=asc"
)

# 查看数据
print(data.Data)
w.close()
```

### 2. 运行示例代码

```bash
python 示例代码.py
```

示例代码提供了5个完整示例：
1. **基础用法** - 获取最近3个月的数据
2. **计算衍生指标** - 添加均线、变化率等指标
3. **全市场数据获取** - 获取全市场融资融券数据
4. **数据可视化** - 生成专业的图表
5. **周度和月度数据** - 不同频率的数据获取

## 📊 返回字段说明

| 字段名 | 说明 | 单位 |
|--------|------|------|
| 融资余额 | 当前融资余额 | 元 |
| 融资余额占流通市值(%) | 占流通市值比例 | % |
| 融资余量 | 融资余量（股数） | 股 |
| 期间买入额 | 期间融资买入金额 | 元 |
| 买入额占A股成交额(%) | 占A股成交额比例 | % |
| 期间偿还额 | 期间融资偿还金额 | 元 |
| 期间净买入额 | 买入额-偿还额 | 元 |
| 期间融资买入个股数 | 买入个股数量 | 只 |
| 占融资标的比(%) | 占融资标的总数比例 | % |

## 🔧 参数配置

### 交易所选项
- `all` - 全部市场 ⚠️ **目前仅支持此选项**

⚠️ **重要提示**: 根据实际测试，此API目前只支持 `exchange=all`，设置为 `sse` 或 `szse` 会返回空数据。

### 数据频率
- `day` - 日度数据
- `week` - 周度数据
- `month` - 月度数据

### 排序方式
- `asc` - 升序（从旧到新）
- `desc` - 降序（从新到旧）

## 💡 使用场景

### 1. 市场情绪分析
融资余额是重要的市场情绪指标：
- **融资余额上升** → 投资者看多，市场情绪乐观
- **融资余额下降** → 投资者看空，市场情绪悲观

### 2. 流动性监控
融资余额占流通市值比例反映市场杠杆水平：
- **比例过高** → 市场杠杆较高，风险增加
- **比例适中** → 市场健康发展

### 3. 资金流向分析
期间净买入额反映资金流向：
- **净买入为正** → 资金流入，看多力量强
- **净买入为负** → 资金流出，看空力量强

### 4. 趋势研判
通过移动平均线判断融资余额趋势：
- 分析市场活跃度变化
- 发现市场转折信号

## 📈 数据分析示例

### 计算衍生指标

```python
# 融资余额日变化
df['融资余额日变化'] = df['融资余额'].diff()

# 融资余额变化率
df['融资余额变化率(%)'] = df['融资余额'].pct_change() * 100

# 移动平均
df['融资余额_5日均'] = df['融资余额'].rolling(window=5).mean()
df['融资余额_20日均'] = df['融资余额'].rolling(window=20).mean()

# 净买入占比
df['净买入占买入比(%)'] = df['期间净买入额'] / df['期间买入额'] * 100
```

### 趋势判断

```python
# 判断融资余额趋势
latest = df.iloc[-1]
if latest['融资余额'] > latest['融资余额_5日均'] > latest['融资余额_20日均']:
    print("融资余额处于上升趋势")
elif latest['融资余额'] < latest['融资余额_5日均'] < latest['融资余额_20日均']:
    print("融资余额处于下降趋势")
else:
    print("融资余额震荡整理")
```

## ⚠️ 注意事项

1. **数据权限**: 需要有效的Wind终端授权
2. **数据延迟**: 数据通常为T+1更新
3. **历史数据**: 部分历史数据可能存在缺失
4. **交易日**: 只有交易日才有数据，非交易日无数据
5. **查询限制**: 建议在交易时间段外进行大量数据查询

## 🔗 相关文档

- [融资余额API使用说明](./融资余额API使用说明.md) - 完整的API文档
- [Wind数据获取完整指南](../Wind数据获取完整指南.md) - Wind API总览
- [示例代码](./示例代码.py) - 可运行的完整示例

## 📞 技术支持

如有问题或建议，请参考：
- Wind官方文档: https://www.wind.com.cn/
- Wind客服: 400-820-9463

## 📝 更新日志

### 2025-10-20
- ✅ 创建融资余额API文档
- ✅ 添加完整示例代码
- ✅ 包含5个实用示例
- ✅ 添加数据可视化功能

---

**版本**: v1.0.0  
**最后更新**: 2025-10-20  
**维护者**: Auto Generated

